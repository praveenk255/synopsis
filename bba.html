<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flight Data Entry</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Legacy grid styling */
    .legacy-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr); /* 3 columns for the first row */
      gap: 16px;
    }

    /* For larger screens, the grid pattern will adjust to fit two items per row after the first row */
    .legacy-grid > div:nth-child(n+4):nth-child(-n+8) {
      grid-column: span 1;
    }

    /* Delay Reason should span full width */
    .legacy-grid > div:last-child {
      grid-column: span 3;
    }

    /* Responsive adjustments for smaller screens */
    @media (max-width: 768px) {
      .legacy-grid {
        grid-template-columns: 1fr 1fr; /* Two items per row on smaller screens */
      }

      .legacy-grid > div:nth-child(n+4):nth-child(-n+8) {
        grid-column: span 1;
      }

      .legacy-grid > div:last-child {
        grid-column: span 2; /* Adjust Delay Reason to span two columns on small screens */
      }
    }
  </style>
</head>
<body class="bg-gray-100 p-6">
  <div class="max-w-4xl mx-auto bg-white p-6 rounded-lg shadow-md">
   
    <form id="flightForm" class="legacy-grid">
      <!-- Flight Number -->
      <div>
        <label for="flightNumber" class="block font-bold mb-2">Flight Number</label>
        <input type="text" id="flightNumber" class="w-full p-2 border rounded" placeholder="e.g., 6E714" required>
      </div>
      <!-- CO Time -->
      <div>
        <label for="co" class="block font-bold mb-2">CO Time</label>
        <input type="text" id="co" inputmode="numeric" pattern="[0-9]*" class="w-full p-2 border rounded time-input" placeholder="HH:MM" maxlength="5" required>
      </div>
      <!-- HO Time -->
      <div>
        <label for="ho" class="block font-bold mb-2">HO Time</label>
        <input type="text" id="ho" inputmode="numeric" pattern="[0-9]*" class="w-full p-2 border rounded time-input" placeholder="HH:MM" maxlength="5" required>
      </div>
      <!-- First Bag -->
      <div>
        <label for="firstBag" class="block font-bold mb-2">First Bag Time</label>
        <input type="text" id="firstBag" inputmode="numeric" pattern="[0-9]*" class="w-full p-2 border rounded time-input" placeholder="HH:MM" maxlength="5" required>
      </div>
      <!-- Last Bag -->
      <div>
        <label for="lastBag" class="block font-bold mb-2">Last Bag Time</label>
        <input type="text" id="lastBag" inputmode="numeric" pattern="[0-9]*" class="w-full p-2 border rounded time-input" placeholder="HH:MM" maxlength="5" required>
      </div>
      <!-- Flight Manager -->
      <div>
        <label for="manager" class="block font-bold mb-2">Flight Manager</label>
        <input type="text" id="manager" class="w-full p-2 border rounded" placeholder="e.g., Chitranshu Pathak" required>
      </div>
      <!-- Arrival Staff -->
      <div>
        <label for="arrivalStaff" class="block font-bold mb-2">Arrival Staff</label>
        <input type="text" id="arrivalStaff" class="w-full p-2 border rounded" placeholder="e.g., Akshat Gupta" required>
      </div>
      <!-- BBA Staff -->
      <div>
        <label for="bbaStaff" class="block font-bold mb-2">BBA Staff</label>
        <input type="text" id="bbaStaff" class="w-full p-2 border rounded" placeholder="e.g., Pritam" required>
      </div>
      <!-- Delay Reason -->
      <div>
        <label for="delayReason" class="block font-bold mb-2">Delay Reason</label>
        <textarea id="delayReason" class="w-full p-2 border rounded" placeholder="e.g., NA"></textarea>
      </div>
    </form>
    <div class="mt-6 grid grid-cols-2 gap-4">
      <!-- WhatsApp Share Button -->
      <button onclick="generateResult()" class="w-full bg-green-500 text-white font-bold py-2 px-4 rounded hover:bg-green-600">
        Share on WhatsApp
      </button>
      <!-- Clear Form Button -->
      <button onclick="clearForm()" class="w-full bg-red-500 text-white font-bold py-2 px-4 rounded hover:bg-red-600">
        Clear Form
      </button>
    </div>
  </div>

  <script>
    // Auto-format time input with colon
    document.querySelectorAll('.time-input').forEach(input => {
      input.addEventListener('input', () => {
        let value = input.value.replace(/[^0-9]/g, '');
        if (value.length > 2) {
          value = value.slice(0, 2) + ':' + value.slice(2, 4);
        }
        input.value = value;
      });
    });

    // Function to parse time
    function parseTime(time) {
      const [hours, minutes] = time.split(':').map(Number);
      return new Date(1970, 0, 1, hours, minutes);
    }

    // Generate the result and share on WhatsApp
function generateResult() {
  const flightNumber = document.getElementById('flightNumber').value;
  const co = document.getElementById('co').value;
  const ho = document.getElementById('ho').value;
  const firstBag = document.getElementById('firstBag').value;
  const lastBag = document.getElementById('lastBag').value;
  const manager = document.getElementById('manager').value;
  const arrivalStaff = document.getElementById('arrivalStaff').value;
  const bbaStaff = document.getElementById('bbaStaff').value;
  const delayReason = document.getElementById('delayReason').value || "NA";

  // Function to format today's date as dd/mm/yy
  function formatDate(date) {
    const day = String(date.getDate()).padStart(2, '0');
    const month = String(date.getMonth() + 1).padStart(2, '0'); // Months are zero-indexed
    const year = String(date.getFullYear()).slice(-2); // Last two digits of the year
    return `${day}/${month}/${year}`;
  }

  const today = new Date();
  const formattedDate = formatDate(today);

  const coTime = parseTime(co);
  const firstBagTime = parseTime(firstBag);
  const lastBagTime = parseTime(lastBag);

  // Calculating statuses
  const fbAchieved = (firstBagTime - coTime) / 60000 <= 10 ? "Achieved" : "Not Achieved";
  const lbAchieved = (lastBagTime - firstBagTime) / 60000 <= 20 ? "Achieved" : "Not Achieved";
  
  // Calculate total time as CO time - Last Bag time
  const totalTime = (lastBagTime - coTime) / 60000;

  // Prepare the result message
  const result = `
    *BBA FB-LB Status*
    *${formattedDate}*
    
    *Flight Number:* ${flightNumber}
    *CO:* ${co}
    *HO:* ${ho}
    *First Bag:* ${firstBag} (${fbAchieved})
    *Last Bag:* ${lastBag} (${lbAchieved})
    *Total Time Taken:* ${totalTime.toFixed(0)} min
    *Flight Manager:* ${manager}
    *Arrival Staff:* ${arrivalStaff}
    *BBA Staff:* ${bbaStaff}
    
    *Delay Reason:* ${delayReason}
  `;

  // Share result on WhatsApp
  const url = `https://wa.me/?text=${encodeURIComponent(result)}`;
  window.open(url, '_blank');
}


    // Clear Form Function
    function clearForm() {
      document.getElementById('flightForm').reset();
    }
  </script>
</body>
</html>
